<section
    id="contacto"
    class="py-32 px-4 bg-neo-black border-t-4 border-neo-lime relative"
>
    <div
        class="absolute top-0 left-1/2 -translate-x-1/2 -translate-y-1/2 bg-neo-lime px-6 py-2 text-black font-black uppercase text-xl rotate-2 border-2 border-white shadow-neo z-20"
    >
        ¿Trabajamos juntos?
    </div>

    <div
        class="max-w-4xl mx-auto bg-[#111] p-8 md:p-12 border border-white/20 shadow-2xl relative overflow-hidden"
    >
        <!-- Decoración esquinas -->
        <div
            class="absolute top-0 left-0 w-4 h-4 border-t-2 border-l-2 border-neo-cyan"
        >
        </div>
        <div
            class="absolute top-0 right-0 w-4 h-4 border-t-2 border-r-2 border-neo-cyan"
        >
        </div>
        <div
            class="absolute bottom-0 left-0 w-4 h-4 border-b-2 border-l-2 border-neo-cyan"
        >
        </div>
        <div
            class="absolute bottom-0 right-0 w-4 h-4 border-b-2 border-r-2 border-neo-cyan"
        >
        </div>

        <!-- FORMULARIO -->
        <form
            id="my-form"
            action="https://formspree.io/f/xdkvjgno"
            method="POST"
            class="grid gap-8 font-mono"
        >
            <div class="group">
                <label class="block text-neo-lime text-sm mb-2"
                    >> INGRESA_TU_NOMBRE</label
                >
                <!-- Importante: name="name" -->
                <input
                    type="text"
                    name="name"
                    required
                    class="w-full bg-black border-b-2 border-white/30 text-white p-4 focus:border-neo-lime focus:bg-white/5 outline-none transition-all placeholder:text-gray-700"
                    placeholder="Ej: Juan Pérez"
                />
            </div>

            <div class="group">
                <label class="block text-neo-lime text-sm mb-2"
                    >> INGRESA_TU_EMAIL</label
                >
                <!-- Importante: name="email" -->
                <input
                    type="email"
                    name="email"
                    required
                    class="w-full bg-black border-b-2 border-white/30 text-white p-4 focus:border-neo-lime focus:bg-white/5 outline-none transition-all placeholder:text-gray-700"
                    placeholder="nombre@empresa.com"
                />
            </div>

            <div class="group">
                <label class="block text-neo-lime text-sm mb-2"
                    >> EJECUTAR_MENSAJE</label
                >
                <!-- Importante: name="message" -->
                <textarea
                    name="message"
                    rows="4"
                    required
                    class="w-full bg-black border-2 border-white/30 text-white p-4 focus:border-neo-cyan outline-none transition-all"
                    placeholder="Cuéntame tu idea..."></textarea>
            </div>

            <button
                id="my-form-button"
                type="submit"
                class="w-full py-5 bg-neo-purple text-white font-black text-xl uppercase tracking-widest hover:bg-white hover:text-neo-purple hover:shadow-[0px_0px_20px_rgba(188,19,254,0.8)] transition-all border border-transparent hover:border-neo-purple"
            >
                [ ENVIAR DATOS ]
            </button>

            <!-- Mensaje de estado -->
            <p id="my-form-status" class="text-center mt-4 text-sm"></p>
        </form>
    </div>
</section>

<!-- SCRIPT AJAX PARA EVITAR REDIRECCIÓN -->
<script is:inline>
    var form = document.getElementById("my-form");

    async function handleSubmit(event) {
        event.preventDefault();
        var status = document.getElementById("my-form-status");
        var btn = document.getElementById("my-form-button");
        var data = new FormData(event.target);

        // Cambiar estado botón
        btn.disabled = true;
        btn.innerText = "ENVIANDO...";

        fetch(event.target.action, {
            method: form.method,
            body: data,
            headers: {
                Accept: "application/json",
            },
        })
            .then((response) => {
                if (response.ok) {
                    status.innerHTML =
                        "¡MENSAJE RECIBIDO! TE CONTACTARÉ PRONTO.";
                    status.className =
                        "text-center mt-4 text-neo-lime font-bold animate-pulse";
                    form.reset();
                    btn.innerText = "[ ENVIADO ]";
                    setTimeout(() => {
                        status.innerHTML = "";
                        btn.disabled = false;
                        btn.innerText = "[ ENVIAR DATOS ]";
                    }, 5000);
                } else {
                    response.json().then((data) => {
                        if (Object.hasOwn(data, "errors")) {
                            status.innerHTML = data["errors"]
                                .map((error) => error["message"])
                                .join(", ");
                        } else {
                            status.innerHTML =
                                "ERROR AL ENVIAR. REVISA TU CONEXIÓN.";
                        }
                        status.className =
                            "text-center mt-4 text-red-500 font-bold";
                        btn.disabled = false;
                        btn.innerText = "[ REINTENTAR ]";
                    });
                }
            })
            .catch((error) => {
                status.innerHTML = "ERROR DE RED. INTENTA MÁS TARDE.";
                status.className = "text-center mt-4 text-red-500 font-bold";
                btn.disabled = false;
                btn.innerText = "[ REINTENTAR ]";
            });
    }

    form.addEventListener("submit", handleSubmit);
</script>
